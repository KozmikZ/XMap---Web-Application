from dataclasses import dataclass
from enum import Enum

class VulnerabilityType(Enum):
    POTENTIAL = "POTENTIAL"
    SERIOUS = "SERIOUS"


@dataclass
class Vulnerability: # Vulnerability object used to handle json vulnerability data with readable code 
    parameter:str
    link:str
    payload:str
    type: VulnerabilityType
    
    def __repr__(self) -> str:
        return f"Vulnerability of parameter {self.parameter} in link {self.link} using payload {self.payload}"
    
    def json(self) -> dict:
        return {
            "parameter":self.parameter,
            "link":self.link,
            "payload":self.payload,
            "type":str(self.type)
        }

        